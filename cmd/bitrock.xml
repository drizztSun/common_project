<project>
    <shortName>EAAClient</shortName>
    <fullName>Enterprise Application Access Client</fullName>
    <version>1.3.2</version>
    <licenseFile>ui/build/license/license.txt</licenseFile>
    <leftImage>images/akamai_win_mgr.png</leftImage>
    <logoImage>images/akamai_win_mgr.png</logoImage>
    <splashImage>images/dmg-background.png</splashImage>
    <wmImage>images/akamai_win_mgr.png</wmImage>
    <componentList>
        <component>
            <name>EAAClient</name>
            <description>${product_fullname}</description>
            <canBeEdited>1</canBeEdited>
            <selected>1</selected>
            <show>1</show>
            <folderList>
                <folder>
                    <description>Program Files</description>
                    <destination>${installdir}\</destination>
                    <name>programfiles</name>
                    <platforms>windows</platforms>
                    <shortcutList>
                        <shortcut>
                            <comment>Uninstall</comment>
                            <exec>${installdir}/${uninstallerName}</exec>
                            <icon></icon>
                            <name>Uninstall ${product_fullname}</name>
                            <path>${installdir}</path>
                            <platforms>windows</platforms>
                            <runAsAdmin>0</runAsAdmin>
                            <runInTerminal>0</runInTerminal>
                            <windowsExec>${installdir}/${uninstallerName}.exe</windowsExec>
                            <windowsExecArgs></windowsExecArgs>
                            <windowsIcon></windowsIcon>
                            <windowsPath>${installdir}</windowsPath>
                        </shortcut>
                    </shortcutList>
                </folder>
                <folder>
                    <description>Device Posture</description>
                    <destination>${installdir}\</destination>
                    <name>deviceposturewin</name>
                    <platforms>windows</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>subinstallers/win</origin>
                        </distributionDirectory>
                    </distributionFileList>
                    <shouldPackRuleList>
                        <fileExists path="subinstallers/win"/>
                    </shouldPackRuleList>
                </folder>
                <folder>
                    <description>Device Posture</description>
                    <destination>${installdir}\</destination>
                    <name>deviceposturewindbg</name>
                    <platforms>windows</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>subinstallers/windbg</origin>
                        </distributionDirectory>
                    </distributionFileList>
                    <shouldPackRuleList>
                        <fileExists path="subinstallers/windbg"/>
                    </shouldPackRuleList>
                </folder>
                <folder>
                    <description>WindowsDestination</description>
                    <destination>${installdir}\</destination>
                    <name>windest</name>
                    <platforms>windows</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>ui/dist/win-unpacked/resources</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>ui/dist/win-unpacked/locales</origin>
                        </distributionDirectory>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/EAAClient.exe</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/msvcp140.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/vcruntime140.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/node.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/pdf_viewer_resources.pak</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/d3dcompiler_47.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/views_resources_200_percent.pak</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/ui_resources_200_percent.pak</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/snapshot_blob.bin</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/natives_blob.bin</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/libGLESv2.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/libEGL.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/content_resources_200_percent.pak</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/content_shell.pak</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/ffmpeg.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/icudtl.dat</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/blink_image_resources_200_percent.pak</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/LICENSES.chromium.html</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/LICENSE.electron.txt</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-string-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-crt-heap-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-crt-private-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-crt-time-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-sysinfo-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-timezone-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-crt-string-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-util-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-crt-stdio-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-crt-utility-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-rtlsupport-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-crt-locale-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-synch-l1-2-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-synch-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-crt-conio-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-crt-convert-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-crt-filesystem-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-crt-math-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-crt-process-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/ucrtbase.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-crt-environment-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-crt-multibyte-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-crt-runtime-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-localization-l1-2-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-namedpipe-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-debug-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-libraryloader-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-processthreads-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-processthreads-l1-1-1.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-console-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-profile-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-file-l2-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-interlocked-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-processenvironment-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-datetime-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-heap-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-memory-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-errorhandling-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-file-l1-2-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-handle-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/api-ms-win-core-file-l1-1-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/prod_cacert.pem</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/stage_cacert.pem</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/eaacloop.png</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/build/version</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/build/winhttp.exe</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/build/wappstart.bat</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/build/wapprun.bat</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/build/wapprestart.bat</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/build/wapphide.vbs</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/build/invisible.vbs</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/build/wappdelclientexe.bat</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/build/Uninstall.exe</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/build/EAACLIENTSTARTUP.xml</origin>
                        </distributionFile>
                        <distributionDirectory>
                            <origin>ui/build/license</origin>
                        </distributionDirectory>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/wapptunneld.exe</origin>
                        </distributionFile>
                        <distributionDirectory>
                            <origin>ui/build/TAPWindows</origin>
                        </distributionDirectory>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/wapprun.exe</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>autoupdate-windows.exe</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/build/appId/AppIdGenerator/bin/Release/AppIdGenerator.exe</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ui/dist/win-unpacked/osqueryd.exe</origin>
                        </distributionFile>
                    </distributionFileList>
                    <ruleList>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </folder>
                <folder>
                    <description>StartMenuProgram</description>
                    <destination>${windows_folder_common_programs}</destination>
                    <name>startmenuprogram</name>
                    <platforms>windows</platforms>
                    <shortcutList>
                        <shortcut>
                            <comment>${product_shortname}-${product_version}</comment>
                            <exec></exec>
                            <icon></icon>
                            <name>${product_fullname}</name>
                            <path></path>
                            <platforms>windows</platforms>
                            <runAsAdmin>0</runAsAdmin>
                            <runInTerminal>0</runInTerminal>
                            <windowsExec>${installdir}\EAAClient.exe</windowsExec>
                            <windowsExecArgs></windowsExecArgs>
                            <windowsIcon></windowsIcon>
                            <windowsPath>${installdir}</windowsPath>
                        </shortcut>
                    </shortcutList>
                </folder>
            </folderList>
        </component>
    </componentList>
    <initializationActionList>
        <actionGroup>
            <actionList>
                <wait>
                    <abortOnError>0</abortOnError>
                    <ms>10000</ms>
                    <showMessageOnError>0</showMessageOnError>
                </wait>
                <showInfo>
                    <text>EAA Client installation is already in progress.</text>
                    <ruleList>
                        <singleInstanceCheck/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </showInfo>
                <logMessage>
                    <text>Exiting the installation as EAA Client installation is already in progress.</text>
                    <ruleList>
                        <singleInstanceCheck/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </logMessage>
                <exit>
                    <exitCode>2</exitCode>
                    <ruleList>
                        <singleInstanceCheck/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </exit>
                <registryGet>
                    <key>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment</key>
                    <name>PROCESSOR_ARCHITECTURE</name>
                    <variable>proarchCheck</variable>
                    <ruleList>
                        <registryTest>
                            <key>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment</key>
                            <logic>exists</logic>
                            <name>PROCESSOR_ARCHITECTURE</name>
                        </registryTest>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </registryGet>
                <showWarning>
                    <progressText>EAAClient 64 bit installer cannot be run on windows 32 bit system. Please install EAAClient 32 bit version installer.</progressText>
                    <text>EAAClient 64 bit installer cannot be run on windows 32 bit system. Please install EAAClient 32 bit version installer.</text>
                    <ruleList>
                        <compareText logic="equals" text="${proarchCheck}" value="x86"/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </showWarning>
                <logMessage>
                    <text>Exiting the installation as EAAClient 64 bit installer cannot be installed on windows 32 bit system. </text>
                    <ruleList>
                        <compareText logic="equals" text="${proarchCheck}" value="x86"/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </logMessage>
                <exit>
                    <exitCode>1</exitCode>
                    <ruleList>
                        <compareText logic="equals" text="${proarchCheck}" value="x86"/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </exit>
                <showQuestion default="yes" text="Do you want to continue with the installation of EAA client version ${product_version} ? " variable="eaacCheck">
                    <ruleList>
                        <fileExists>
                            <path>${installdir}\EAAClient.exe</path>
                        </fileExists>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </showQuestion>
                <showQuestion default="yes" text="Do you want to continue with the installation of EAA client version ${product_version} ? " variable="eaacCheck">
                    <ruleList>
                        <fileExists>
                            <path>${Oldinstalldir}\EAAClient.exe</path>
                        </fileExists>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </showQuestion>
                <exit>
                    <customErrorMessage>Installation aborted by user.</customErrorMessage>
                    <exitCode>1</exitCode>
                    <ruleList>
                        <compareText logic="equals" text="${eaacCheck}" value="no"/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </exit>
                <createDirectory>
                    <path>${system_temp_directory}\EAACautoupdate\</path>
                    <ruleList>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </createDirectory>
                <copyFile>
                    <abortOnError>0</abortOnError>
                    <destination>${system_temp_directory}\EAACautoupdate\</destination>
                    <origin>${Oldinstalldir}\log\stderr.txt</origin>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                        <fileExists>
                            <path>${Oldinstalldir}\log\stderr.txt</path>
                        </fileExists>
                    </ruleList>
                </copyFile>
                <copyFile>
                    <abortOnError>0</abortOnError>
                    <destination>${system_temp_directory}\EAACautoupdate\</destination>
                    <origin>${Oldinstalldir}\log\stdout.txt</origin>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                        <fileExists>
                            <path>${Oldinstalldir}\log\stdout.txt</path>
                        </fileExists>
                    </ruleList>
                </copyFile>
                <copyFile>
                    <abortOnError>0</abortOnError>
                    <destination>${system_temp_directory}\EAACautoupdate\</destination>
                    <origin>${Oldinstalldir}\log\eaaclient.log</origin>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                        <fileExists>
                            <path>${Oldinstalldir}\log\eaaclient.log</path>
                        </fileExists>
                    </ruleList>
                </copyFile>
                <copyFile>
                    <abortOnError>0</abortOnError>
                    <destination>${system_temp_directory}\EAACautoupdate\</destination>
                    <origin>${Oldinstalldir}\bin\dbstore</origin>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                        <fileExists>
                            <path>${Oldinstalldir}\bin\dbstore</path>
                        </fileExists>
                    </ruleList>
                </copyFile>
                <copyFile>
                    <abortOnError>0</abortOnError>
                    <destination>${system_temp_directory}\EAACautoupdate\</destination>
                    <origin>${installdir}\log\stderr.txt</origin>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                        <fileExists>
                            <path>${installdir}\log\stderr.txt</path>
                        </fileExists>
                    </ruleList>
                </copyFile>
                <copyFile>
                    <abortOnError>0</abortOnError>
                    <destination>${system_temp_directory}\EAACautoupdate\</destination>
                    <origin>${installdir}\log\stdout.txt</origin>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                        <fileExists>
                            <path>${installdir}\log\stdout.txt</path>
                        </fileExists>
                    </ruleList>
                </copyFile>
                <copyFile>
                    <abortOnError>0</abortOnError>
                    <destination>${system_temp_directory}\EAACautoupdate\</destination>
                    <origin>${installdir}\log\eaaclient.log</origin>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                        <fileExists>
                            <path>${installdir}\log\eaaclient.log</path>
                        </fileExists>
                    </ruleList>
                </copyFile>
                <copyFile>
                    <abortOnError>0</abortOnError>
                    <destination>${system_temp_directory}\EAACautoupdate\</destination>
                    <origin>${installdir}\bin\dbstore</origin>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                        <fileExists>
                            <path>${installdir}\bin\dbstore</path>
                        </fileExists>
                    </ruleList>
                </copyFile>
                <copyFile>
                    <abortOnError>0</abortOnError>
                    <destination>${system_temp_directory}\EAACautoupdate\</destination>
                    <origin>${windows_folder_appdata}\EAAClient\logs\activity.log</origin>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                        <fileExists>
                            <path>${windows_folder_appdata}\EAAClient\logs\activity.log</path>
                        </fileExists>
                    </ruleList>
                </copyFile>
            </actionList>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </actionGroup>
        <showProgressDialog>
            <title>Please wait ...</title>
            <actionList>
                <stopWindowsService>
                    <delay>15000</delay>
                    <displayName>Enterprise Client Connector</displayName>
                    <serviceName>etpClient</serviceName>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                        <windowsServiceTest>
                            <condition>exists</condition>
                            <service>etpClient</service>
                        </windowsServiceTest>
                        <windowsServiceTest>
                            <condition>is_running</condition>
                            <service>etpClient</service>
                        </windowsServiceTest>
                    </ruleList>
                </stopWindowsService>
                <wait>
                    <abortOnError>0</abortOnError>
                    <ms>3000</ms>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </wait>
                <kill>
                    <abortOnError>0</abortOnError>
                    <name>wapprun.exe</name>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </kill>
                <logMessage>
                    <abortOnError>0</abortOnError>
                    <showMessageOnError>0</showMessageOnError>
                    <text>Killing the process "wapprun.exe".</text>
                    <ruleList>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </logMessage>
                <kill>
                    <abortOnError>0</abortOnError>
                    <name>EAACLI~1.EXE</name>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <processTest>
                            <logic>is_running</logic>
                            <name>EAACLI~1.EXE</name>
                        </processTest>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </kill>
                <logMessage>
                    <abortOnError>0</abortOnError>
                    <showMessageOnError>0</showMessageOnError>
                    <text>Killing process "EAACLI~1.EXE".</text>
                    <ruleList>
                        <processTest>
                            <logic>is_running</logic>
                            <name>EAACLI~1.EXE</name>
                        </processTest>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </logMessage>
                <kill>
                    <abortOnError>0</abortOnError>
                    <name>EAAClient.exe</name>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <processTest>
                            <logic>is_running</logic>
                            <name>EAAClient.exe</name>
                        </processTest>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </kill>
                <logMessage>
                    <abortOnError>0</abortOnError>
                    <showMessageOnError>0</showMessageOnError>
                    <text>Killing "EAAClient.exe" process.</text>
                    <ruleList>
                        <processTest>
                            <logic>is_running</logic>
                            <name>EAAClient.exe</name>
                        </processTest>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </logMessage>
                <wait>
                    <abortOnError>0</abortOnError>
                    <ms>3000</ms>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </wait>
                <deleteWindowsService>
                    <displayName>wapptunneld</displayName>
                    <explanation>Stopping Tunneld Service</explanation>
                    <serviceName>EAAClient</serviceName>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </deleteWindowsService>
                <logMessage>
                    <abortOnError>0</abortOnError>
                    <explanation>Stopping Tunneld Service</explanation>
                    <showMessageOnError>0</showMessageOnError>
                    <text>Deleting "EAAClient" Service with display name "wapptunneld".</text>
                    <ruleList>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </logMessage>
                <deleteWindowsService>
                    <displayName>Akamai Osquery</displayName>
                    <explanation>Stopping Akamai Osquery Service</explanation>
                    <serviceName>Akamai Osquery</serviceName>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </deleteWindowsService>
                <logMessage>
                    <abortOnError>0</abortOnError>
                    <explanation>Stopping Akamai Osquery Service</explanation>
                    <showMessageOnError>0</showMessageOnError>
                    <text>Deleting "Akamai Osquery" Service with display name "Akamai Osquery".</text>
                    <ruleList>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </logMessage>
                <wait>
                    <abortOnError>0</abortOnError>
                    <ms>3000</ms>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </wait>
                <runProgram>
                    <abortOnError>0</abortOnError>
                    <program>${installdir}\uninstall.exe</program>
                    <programArguments></programArguments>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                        <fileExists>
                            <path>${installdir}\uninstall.exe</path>
                        </fileExists>
                    </ruleList>
                </runProgram>
                <wait ms="2000" progressText="Preparing the system for EAA Client install...">
                    <abortOnError>0</abortOnError>
                    <showMessageOnError>0</showMessageOnError>
                </wait>
                <wait ms="2000" progressText="Preparing the system for EAA Client install...">
                    <abortOnError>0</abortOnError>
                    <showMessageOnError>0</showMessageOnError>
                </wait>
                <wait ms="1000" progressText="Preparing the system for EAA Client install...">
                    <abortOnError>0</abortOnError>
                    <showMessageOnError>0</showMessageOnError>
                </wait>
                <wait ms="5000" progressText="Preparing the system for EAA Client install....">
                    <abortOnError>0</abortOnError>
                    <showMessageOnError>0</showMessageOnError>
                </wait>
                <wait ms="5000" progressText="Preparing the system for EAA Client install....">
                    <abortOnError>0</abortOnError>
                    <showMessageOnError>0</showMessageOnError>
                </wait>
                <wait ms="5000" progressText="Preparing the system for EAA Client install....">
                    <abortOnError>0</abortOnError>
                    <showMessageOnError>0</showMessageOnError>
                </wait>
                <wait ms="1000" progressText="Preparing the system for EAA Client install.....">
                    <abortOnError>0</abortOnError>
                    <showMessageOnError>0</showMessageOnError>
                </wait>
                <wait ms="1000" progressText="Preparing the system for EAA Client install.....">
                    <abortOnError>0</abortOnError>
                    <showMessageOnError>0</showMessageOnError>
                </wait>
                <wait ms="1000" progressText="Preparing the system for EAA Client install.....">
                    <abortOnError>0</abortOnError>
                    <showMessageOnError>0</showMessageOnError>
                </wait>
                <wait ms="2000" progressText="Preparing the system for EAA Client install.......">
                    <abortOnError>0</abortOnError>
                    <showMessageOnError>0</showMessageOnError>
                </wait>
                <startWindowsService>
                    <delay>15000</delay>
                    <displayName>Enterprise Client Connector</displayName>
                    <serviceName>etpClient</serviceName>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                        <windowsServiceTest>
                            <condition>exists</condition>
                            <service>etpClient</service>
                        </windowsServiceTest>
                        <windowsServiceTest>
                            <condition>is_not_running</condition>
                            <service>etpClient</service>
                        </windowsServiceTest>
                    </ruleList>
                </startWindowsService>
                <wait ms="3000" progressText="Preparing the system for EAA Client install.......">
                    <abortOnError>0</abortOnError>
                    <showMessageOnError>0</showMessageOnError>
                </wait>
            </actionList>
        </showProgressDialog>
    </initializationActionList>
    <preInstallationActionList>
        <showProgressDialog>
            <title> Checking outdated installation ... </title>
            <actionList>
                <if>
                    <conditionRulist>
                        <windowsServiceTest service='Akamai Device Posture' condition='exists'/> 
                    </conditionRulist>
                    <setInstallationVariable name='dpc_installationdir' value='C:/ProgramData/osquery'/>
                    <stopWindowsService>
                        <serviceName>Akamai Device Posture</serviceName>
                        <ruleList>
                            <fileExists>
                                <path>${dpc_installationdir}/akadp.ext.exe</path>
                            </fileExists>
                            <platformTest>
                                <type>windows</type>
                            </platformTest>
                        </ruleList>
                    </stopWindowsService>
                    <wait ms="2000" progressText="Stop Akamai Device Posture .......">
                        <abortOnError>0</abortOnError>
                        <showMessageOnError>0</showMessageOnError>
                    </wait>
                    <stopWindowsService>
                        <serviceName>Akamai Osquery Daemon</serviceName>
                        <ruleList>
                            <fileExists>
                                <path>${dpc_installationdir}/akadp.ext.exe</path>
                            </fileExists>
                            <platformTest>
                                <type>windows</type>
                            </platformTest>
                        </ruleList>
                    </stopWindowsService>
                    <wait ms="10000" progressText="Stop Akamai Osquery Daemon .......">
                        <abortOnError>0</abortOnError>
                        <showMessageOnError>0</showMessageOnError>
                    </wait>
                    <runProgram>
                        <abortOnError>0</abortOnError>
                        <program>DEL ${dpc_installationdir}\*.*</program>
                        <programArguments>/F /Q</programArguments>
                        <showMessageOnError>0</showMessageOnError>
                        <ruleList>
                            <fileExists>
                                <path>${dpc_installationdir}</path>
                            </fileExists>
                            <platformTest>
                                <type>windows</type>
                            </platformTest>
                        </ruleList>
                    </runProgram>
                    <wait ms="2000" progressText="Remove installation folder .......">
                        <abortOnError>0</abortOnError>
                        <showMessageOnError>0</showMessageOnError>
                    </wait>
                    <runProgram>
                        <abortOnError>0</abortOnError>
                        <program>RD ${dpc_installationdir}</program>
                        <programArguments>/S /Q</programArguments>
                        <showMessageOnError>0</showMessageOnError>
                        <ruleList>
                            <fileExists>
                                <path>${dpc_installationdir}</path>
                            </fileExists>
                            <platformTest>
                                <type>windows</type>
                            </platformTest>
                        </ruleList>
                    </runProgram>
                    <wait ms="2000" progressText="Remove installation folder .......">
                        <abortOnError>0</abortOnError>
                        <showMessageOnError>0</showMessageOnError>
                    </wait>
                </if>
            </actionList>
        </showProgressDialog>
    </preInstallationActionList>
    <postInstallationActionList>
        <createDirectory>
            <abortOnError>0</abortOnError>
            <path>${env(SYSTEMDRIVE)}\EAAClient</path>
        </createDirectory>
        <writeFile>
            <abortOnError>0</abortOnError>
            <path>${installdir}\IDP.ini</path>
            <showMessageOnError>0</showMessageOnError>
            <text>url = ${url}</text>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </writeFile>
        <copyFile>
            <abortOnError>0</abortOnError>
            <destination>${installdir}\wapprun.exe.backup</destination>
            <origin>${Oldinstalldir}\wapprun.exe</origin>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${Oldinstalldir}\wapprun.exe</path>
                </fileExists>
            </ruleList>
        </copyFile>
        <copyFile>
            <abortOnError>0</abortOnError>
            <destination>${installdir}\wapptunneld.exe.backup</destination>
            <origin>${Oldinstalldir}\wapptunneld.exe</origin>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${Oldinstalldir}\wapptunneld.exe</path>
                </fileExists>
            </ruleList>
        </copyFile>
        <copyFile>
            <abortOnError>0</abortOnError>
            <destination>${installdir}\wapprun.exe.backup</destination>
            <origin>${installdir}\wapprun.exe</origin>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${installdir}\wapprun.exe</path>
                </fileExists>
            </ruleList>
        </copyFile>
        <copyFile>
            <abortOnError>0</abortOnError>
            <destination>${installdir}\wapptunneld.exe.backup</destination>
            <origin>${installdir}\wapptunneld.exe</origin>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${installdir}\wapptunneld.exe</path>
                </fileExists>
            </ruleList>
        </copyFile>
        <writeFile>
            <abortOnError>0</abortOnError>
            <path>${installdir}\update.ini</path>
            <showMessageOnError>0</showMessageOnError>
            <text>[Update]
url =https://s3-us-west-1.amazonaws.com/downloads.akamai-access.com/updates/updatex64.xml
version_id = 121
check_for_updates = 1
update_download_location = ${system_temp_directory}\EAACautoupdate
</text>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </writeFile>
        <createDirectory>
            <abortOnError>0</abortOnError>
            <path>${installdir}\bin</path>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </createDirectory>
        <createDirectory>
            <abortOnError>0</abortOnError>
            <path>${installdir}\log</path>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </createDirectory>
        <createDirectory>
            <abortOnError>0</abortOnError>
            <path>${installdir}\osquery</path>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </createDirectory>
        <copyFile>
            <origin>${installdir}/osqueryd.exe</origin>
            <destination>${installdir}/osquery</destination>
        </copyFile>
        <copyFile>
            <abortOnError>0</abortOnError>
            <destination>${installdir}\log</destination>
            <origin>${system_temp_directory}\EAACautoupdate\stderr.txt</origin>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${system_temp_directory}\EAACautoupdate\stderr.txt</path>
                </fileExists>
            </ruleList>
        </copyFile>
        <copyFile>
            <abortOnError>0</abortOnError>
            <destination>${installdir}\log</destination>
            <origin>${system_temp_directory}\EAACautoupdate\stdout.txt</origin>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${system_temp_directory}\EAACautoupdate\stdout.txt</path>
                </fileExists>
            </ruleList>
        </copyFile>
        <copyFile>
            <abortOnError>0</abortOnError>
            <destination>${installdir}\log</destination>
            <origin>${system_temp_directory}\EAACautoupdate\eaaclient.log</origin>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${system_temp_directory}\EAACautoupdate\eaaclient.log</path>
                </fileExists>
            </ruleList>
        </copyFile>
        <copyFile>
            <abortOnError>0</abortOnError>
            <destination>${windows_folder_appdata}\EAAClient\logs</destination>
            <origin>${system_temp_directory}\EAACautoupdate\activity.log</origin>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${system_temp_directory}\EAACautoupdate\activity.log</path>
                </fileExists>
            </ruleList>
        </copyFile>
        <copyFile>
            <abortOnError>0</abortOnError>
            <destination>${installdir}\bin</destination>
            <origin>${system_temp_directory}\EAACautoupdate\dbstore</origin>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <compareText logic="equals" text="${eaacCheck}" value="yes"/>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${system_temp_directory}\EAACautoupdate\dbstore</path>
                </fileExists>
            </ruleList>
        </copyFile>
        <runProgram>
            <abortOnError>0</abortOnError>
            <explanation>Delete EAAClient Interface</explanation>
            <program>${installdir}\TAPWindows\bin\tapinstall.exe</program>
            <programArguments>remove tap0901</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <useMSDOSPath>0</useMSDOSPath>
            <ruleList>
                <platformTest type="windows-7"/>
                <fileExists>
                    <path>${installdir}\TAPWindows\bin\tapinstall.exe</path>
                </fileExists>
            </ruleList>
        </runProgram>
        <runProgram>
            <abortOnError>0</abortOnError>
            <explanation>Delete EAAClient Interface</explanation>
            <program>${installdir}\TAPWindows\bin\tapinstall.exe</program>
            <programArguments>remove eaatap</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <useMSDOSPath>0</useMSDOSPath>
            <ruleList>
                <platformTest negate="1" type="windows-7"/>
                <fileExists>
                    <path>${installdir}\TAPWindows\bin\tapinstall.exe</path>
                </fileExists>
            </ruleList>
        </runProgram>
        <wait>
            <abortOnError>0</abortOnError>
            <ms>3000</ms>
            <showMessageOnError>0</showMessageOnError>
        </wait>
        <runProgram>
            <abortOnError>0</abortOnError>
            <program>${installdir}\TAPWindows\bin\tapinstall.exe</program>
            <programArguments>install "${installdir}\TAPWindows\driver\OemVista.inf" tap0901</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest type="windows-7"/>
            </ruleList>
        </runProgram>
        <runProgram>
            <abortOnError>0</abortOnError>
            <program>${installdir}\TAPWindows\bin\tapinstall.exe</program>
            <programArguments>install "${installdir}\TAPWindows\eaatap\OemVista.inf" eaatap</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest negate="1" type="windows-7"/>
            </ruleList>
        </runProgram>
        <runProgram>
            <abortOnError>0</abortOnError>
            <program>schtasks.exe</program>
            <programArguments>/CREATE /TN EAACLIENTSTARTUP /XML "${installdir}\EAACLIENTSTARTUP.xml"</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <runProgram>
            <abortOnError>0</abortOnError>
            <program>sc.exe</program>
            <programArguments>create EAAClient DisplayName= wapptunneld binPath= "${installdir}\wapptunneld.exe" type= own start= auto error= ignore</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <runProgram>
            <abortOnError>0</abortOnError>
            <program>sc.exe</program>
            <programArguments>failure EAAClient reset= 86400 actions= restart/2000/restart/4000/restart/8000</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <runProgram>
            <abortOnError>0</abortOnError>
            <program>sc.exe</program>
            <programArguments>start EAAClient</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <runProgram>
            <abortOnError>0</abortOnError>
            <program>sc.exe</program>
            <programArguments>create "Akamai Osquery" DisplayName= "Akamai Osquery" binPath= "${installdir}\osquery\osqueryd.exe --allow_unsafe --config_plugin=akamai_config --extensions_timeout=10 --extensions_require=akamai_config --extensions_socket=\\.\pipe\posture.em --database_path=\"C:\Program Files\EAAClient\osquery_3_3_2.db\" " type= own start= auto error= ignore</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <runProgram>
            <abortOnError>0</abortOnError>
            <program>sc.exe</program>
            <programArguments>failure "Akamai Osquery" reset= 86400 actions= restart/2000/restart/4000/restart/8000</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <runProgram>
            <abortOnError>0</abortOnError>
            <program>sc.exe</program>
            <programArguments>start "Akamai Osquery"</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <wait ms="2000" progressText="Running post install checks..      ">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
        </wait>
        <wait ms="2000" progressText="Running post install checks....    ">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
        </wait>
        <wait ms="1000" progressText="Running post install checks........">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
        </wait>
        <wait ms="5000" progressText="Enabling services..      ">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
        </wait>
        <wait ms="5000" progressText="Enabling services.....   ">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
        </wait>
        <wait ms="5000" progressText="Enabling services.......">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
        </wait>
        <wait ms="1000" progressText="Starting EAA Client install.          ">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
        </wait>
        <wait ms="1000" progressText="Starting EAA Client install..     ">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
        </wait>
        <wait ms="1000" progressText="Starting EAA Client install...  ">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
        </wait>
        <wait ms="1000" progressText="Starting EAA Client install....  ">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
        </wait>
        <wait ms="1000" progressText="Starting EAA Client install.....">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
        </wait>
        <runProgram>
            <abortOnError>0</abortOnError>
            <explanation>Set AppUserModelId(AppId)</explanation>
            <program>${installdir}\AppIdGenerator.exe</program>
            <programArguments></programArguments>
            <showMessageOnError>0</showMessageOnError>
        </runProgram>
        <runProgram>
            <abortOnError>0</abortOnError>
            <explanation>Start EAAClient</explanation>
            <program>${installdir}\EAAClient.exe</program>
            <programArguments>&amp;</programArguments>
            <runAs>${env(USER)}</runAs>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <compareText>
                    <logic>does_not_equal</logic>
                    <text>${autostart}</text>
                    <value>no</value>
                </compareText>
            </ruleList>
        </runProgram>
        <wait ms="2000" progressText="Starting EAA Client install......         ">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
        </wait>
        <wait ms="2000" progressText="Starting EAA Client install.......     ">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
        </wait>
        <wait ms="2000" progressText="Starting EAA Client install........   ">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
        </wait>
        <wait ms="2000" progressText="Starting EAA Client install.........  ">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
        </wait>
        <wait ms="2000" progressText="Starting EAA Client install...........">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
        </wait>
        <registrySet>
            <abortOnError>0</abortOnError>
            <key>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</key>
            <name>EAAClient</name>
            <showMessageOnError>0</showMessageOnError>
            <type>REG_SZ</type>
            <value>${installdir}\EAAClient.exe /S</value>
        </registrySet>
        <runProgram>
            <abortOnError>0</abortOnError>
            <program>msiexec</program>
            <programArguments>/i "${installdir}\win\akamai-device-posture-1.3.2.msi" /Q</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${installdir}\win\akamai-device-posture-1.3.2.msi</path>
                </fileExists>
            </ruleList>
        </runProgram>
        <wait ms="1000" progressText="Installing Device Posture Client..">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${installdir}\win\akamai-device-posture-1.3.2.msi</path>
                </fileExists>
            </ruleList>
        </wait>
        <wait ms="1000" progressText="Installing Device Posture Client....">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${installdir}\win\akamai-device-posture-1.3.2.msi</path>
                </fileExists>
            </ruleList>
        </wait>
        <wait ms="1000" progressText="Installing Device Posture Client......">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${installdir}\win\akamai-device-posture-1.3.2.msi</path>
                </fileExists>
            </ruleList>
        </wait>
        <wait ms="1000" progressText="Installing Device Posture Client........">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${installdir}\win\akamai-device-posture-1.3.2.msi</path>
                </fileExists>
            </ruleList>
        </wait>
        <wait ms="1000" progressText="Installing Device Posture Client..........">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${installdir}\win\akamai-device-posture-1.3.2.msi</path>
                </fileExists>
            </ruleList>
        </wait>
        <runProgram>
            <abortOnError>0</abortOnError>
            <program>msiexec</program>
            <programArguments>/i "${installdir}\windbg\akamai-device-posture-1.3.2.msi" /Q</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${installdir}\windbg\akamai-device-posture-1.3.2.msi</path>
                </fileExists>
            </ruleList>
        </runProgram>
        <wait ms="1000" progressText="Installing Device Posture Client..">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${installdir}\windbg\akamai-device-posture-1.3.2.msi</path>
                </fileExists>
            </ruleList>
        </wait>
        <wait ms="1000" progressText="Installing Device Posture Client....">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${installdir}\windbg\akamai-device-posture-1.3.2.msi</path>
                </fileExists>
            </ruleList>
        </wait>
        <wait ms="1000" progressText="Installing Device Posture Client......">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${installdir}\windbg\akamai-device-posture-1.3.2.msi</path>
                </fileExists>
            </ruleList>
        </wait>
        <wait ms="1000" progressText="Installing Device Posture Client........">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${installdir}\windbg\akamai-device-posture-1.3.2.msi</path>
                </fileExists>
            </ruleList>
        </wait>
        <wait ms="1000" progressText="Installing Device Posture Client..........">
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${installdir}\windbg\akamai-device-posture-1.3.2.msi</path>
                </fileExists>
            </ruleList>
        </wait>
    </postInstallationActionList>
    <preUninstallationActionList>
        <stopWindowsService>
            <delay>15000</delay>
            <displayName>Enterprise Client Connector</displayName>
            <serviceName>etpClient</serviceName>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <windowsServiceTest>
                    <condition>exists</condition>
                    <service>etpClient</service>
                </windowsServiceTest>
                <windowsServiceTest>
                    <condition>is_running</condition>
                    <service>etpClient</service>
                </windowsServiceTest>
            </ruleList>
        </stopWindowsService>
        <runProgram>
            <abortOnError>0</abortOnError>
            <explanation>Deleting wapptunneld Services</explanation>
            <program>schtasks.exe</program>
            <programArguments>/Delete /TN "EAACLIENTSTARTUP" /F</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <kill>
            <abortOnError>0</abortOnError>
            <name>wapprun.exe</name>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </kill>
        <logMessage>
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
            <text>killing process "wapprun.exe" with exitcode ${program_exit_code}.</text>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </logMessage>
        <kill>
            <abortOnError>0</abortOnError>
            <name>EAACLI~1.EXE</name>
            <path>${installdir}</path>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <processTest>
                    <logic>is_running</logic>
                    <name>EAACLI~1.EXE</name>
                </processTest>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </kill>
        <logMessage>
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
            <text>killing process "EAACLI~1.EXE" with exitcode ${program_exit_code}.</text>
            <ruleList>
                <processTest>
                    <logic>is_running</logic>
                    <name>EAACLI~1.EXE</name>
                </processTest>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </logMessage>
        <kill>
            <abortOnError>0</abortOnError>
            <name>EAAClient.exe</name>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <processTest>
                    <logic>is_running</logic>
                    <name>EAAClient.exe</name>
                </processTest>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </kill>
        <logMessage>
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
            <text>killing process "EAAClient.exe" with exitcode ${program_exit_code}.</text>
            <ruleList>
                <processTest>
                    <logic>is_running</logic>
                    <name>EAAClient.exe</name>
                </processTest>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </logMessage>
        <deleteWindowsService>
            <displayName>wapptunneld</displayName>
            <explanation>Stopping Tunneld Service</explanation>
            <serviceName>EAAClient</serviceName>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </deleteWindowsService>
        <logMessage>
            <abortOnError>0</abortOnError>
            <showMessageOnError>0</showMessageOnError>
            <text>killing service "EAAClient.exe" with exitcode ${program_exit_code}.</text>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <windowsServiceTest>
                    <condition>is_running</condition>
                    <service>EAAClient</service>
                </windowsServiceTest>
            </ruleList>
        </logMessage>
        <runProgram>
            <abortOnError>0</abortOnError>
            <explanation>Delete EAAClient Interface</explanation>
            <program>${installdir}\TAPWindows\bin\tapinstall.exe</program>
            <programArguments>remove tap0901</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <useMSDOSPath>0</useMSDOSPath>
            <ruleList>
                <platformTest type="windows-7"/>
                <fileExists>
                    <path>${installdir}\TAPWindows\bin\tapinstall.exe</path>
                </fileExists>
            </ruleList>
        </runProgram>
        <runProgram>
            <abortOnError>0</abortOnError>
            <explanation>Delete EAAClient Interface</explanation>
            <program>${installdir}\TAPWindows\bin\tapinstall.exe</program>
            <programArguments>remove eaatap</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <useMSDOSPath>0</useMSDOSPath>
            <ruleList>
                <platformTest negate="1" type="windows-7"/>
                <fileExists>
                    <path>${installdir}\TAPWindows\bin\tapinstall.exe</path>
                </fileExists>
            </ruleList>
        </runProgram>
        <runProgram>
            <abortOnError>0</abortOnError>
            <program>msiexec</program>
            <programArguments>/Q /X {EA1FEE22-8864-434C-A3C2-A53B94324410}</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <registryTest>
                    <key>HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\{EA1FEE22-8864-434C-A3C2-A53B94324410}</key>
                    <logic>exists</logic>
                    <name></name>
                </registryTest>
            </ruleList>
        </runProgram>
        <logMessage>
            <text>Delete ${env(SYSTEMDRIVE)}\EAAClient\interface.json</text>
        </logMessage>
        <deleteFile>
            <abortOnError>0</abortOnError>
            <path>${env(SYSTEMDRIVE)}\EAAClient\interface.json</path>
            <showMessageOnError>0</showMessageOnError>
        </deleteFile>
        <deleteFile>
            <abortOnError>0</abortOnError>
            <path>${env(SYSTEMDRIVE)}\EAAClient</path>
            <showMessageOnError>0</showMessageOnError>
        </deleteFile>
        <runProgram>
            <abortOnError>0</abortOnError>
            <program>RD ${env(SYSTEMDRIVE)}\EAAClient</program>
            <programArguments>/S /Q</programArguments>
            <showMessageOnError>0</showMessageOnError>
        </runProgram>
    </preUninstallationActionList>
    <postUninstallationActionList>
        <startWindowsService>
            <delay>15000</delay>
            <displayName>Enterprise Client Connector</displayName>
            <serviceName>etpClient</serviceName>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <windowsServiceTest>
                    <condition>exists</condition>
                    <service>etpClient</service>
                </windowsServiceTest>
                <windowsServiceTest>
                    <condition>is_not_running</condition>
                    <service>etpClient</service>
                </windowsServiceTest>
            </ruleList>
        </startWindowsService>
        <deleteFile>
            <abortOnError>0</abortOnError>
            <path>${installdir}</path>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </deleteFile>
        <registryDelete>
            <abortOnError>0</abortOnError>
            <key>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</key>
            <name>EAAClient</name>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <registryTest>
                    <key>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</key>
                    <logic>exists</logic>
                    <name>EAAClient</name>
                </registryTest>
            </ruleList>
        </registryDelete>
        <runProgram>
            <abortOnError>0</abortOnError>
            <program>DEL ${installdir}\*.*</program>
            <programArguments>/F /Q</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <fileExists>
                    <path>${installdir}</path>
                </fileExists>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <runProgram>
            <abortOnError>0</abortOnError>
            <program>RD ${installdir}</program>
            <programArguments>/S /Q</programArguments>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <fileExists>
                    <path>${installdir}</path>
                </fileExists>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </runProgram>
    </postUninstallationActionList>
    <defaultInstallationMode>unattended</defaultInstallationMode>
    <enableRollback>1</enableRollback>
    <enableSslSupport>1</enableSslSupport>
    <enableTimestamp>1</enableTimestamp>
    <osxApplicationBundleIdentifier></osxApplicationBundleIdentifier>
    <osxDmgTitle></osxDmgTitle>
    <osxPlatforms></osxPlatforms>
    <osxSigningTimestampServer></osxSigningTimestampServer>
    <outputDirectory>releases</outputDirectory>
    <productDisplayIcon>images/akamai_win_mgr.png</productDisplayIcon>
    <replaceLockedFilesOnReboot>1</replaceLockedFilesOnReboot>
    <requireInstallationByRootUser>1</requireInstallationByRootUser>
    <saveRelativePaths>1</saveRelativePaths>
    <singleInstanceCheck>1</singleInstanceCheck>
    <startMenuGroupName></startMenuGroupName>
    <unattendedModeUI>minimalWithDialogs</unattendedModeUI>
    <vendor>Akamai Technologies, Inc.</vendor>
    <windows64bitMode>1</windows64bitMode>
    <windowsExecutableIcon>images/akamai_win_pkg.ico</windowsExecutableIcon>
    <windowsResourceOriginalFilename>EAAClient.exe</windowsResourceOriginalFilename>
    <windowsUninstallerExecutableIcon>images/akamai_win_pkg.ico</windowsUninstallerExecutableIcon>
    <customLanguageFileList>
        <language>
            <code>en</code>
            <file>custom-en.lng</file>
        </language>
    </customLanguageFileList>
    <parameterList>
        <booleanParameter>
            <name>autostart</name>
            <description></description>
            <explanation></explanation>
            <value></value>
            <default></default>
            <ask>0</ask>
        </booleanParameter>
        <stringParameter name="url" ask="no">
            <description></description>
            <explanation></explanation>
            <value></value>
            <default></default>
            <allowEmptyValue>1</allowEmptyValue>
            <width>30</width>
        </stringParameter>
        <directoryParameter>
            <name>installdir</name>
            <description>Installer.Parameter.installdir.description</description>
            <explanation>Installer.Parameter.installdir.explanation</explanation>
            <value></value>
            <default>${platform_install_prefix}\${product_shortname}</default>
            <allowEmptyValue>0</allowEmptyValue>
            <ask>0</ask>
            <cliOptionName>prefix</cliOptionName>
            <mustBeWritable>1</mustBeWritable>
            <mustExist>0</mustExist>
            <width>30</width>
        </directoryParameter>
        <directoryParameter>
            <name>Oldinstalldir</name>
            <description></description>
            <explanation></explanation>
            <value></value>
            <default>${env(SYSTEMDRIVE)}\${product_shortname}\</default>
            <allowEmptyValue>0</allowEmptyValue>
            <mustBeWritable>1</mustBeWritable>
            <mustExist>0</mustExist>
            <width>30</width>
        </directoryParameter>
    </parameterList>
</project>

